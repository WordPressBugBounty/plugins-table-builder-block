(()=>{"use strict";var e,t={746:(e,t,l)=>{var o=l(609);const r=window.wp.blocks,a=window.wp.i18n,n=window.wp.blockEditor,i=JSON.parse('{"UU":"tablebuilder/table-builder","uK":{"blockID":{"type":"string"},"blockClass":{"type":"string"},"blocksCSS":{"type":"object"},"hasFixedLayout":{"type":"boolean","default":true},"caption":{"type":"string"},"captionPosition":{"type":"string","default":"bottom"},"rowCount":{"type":"number","default":2},"columnCount":{"type":"number","default":2},"hasBorderCollaps":{"type":"boolean","default":true},"borderVerticalSpacingDesktop":{"type":"object"},"borderVerticalSpacingTablet":{"type":"object"},"borderVerticalSpacingMobile":{"type":"object"},"borderVerticalSpacingTabletLandscape":{"type":"object"},"borderVerticalSpacingMobileLandscape":{"type":"object"},"borderVerticalSpacingLaptop":{"type":"object"},"borderVerticalSpacingWideScreen":{"type":"object"},"borderHorizontalSpacingDesktop":{"type":"object"},"borderHorizontalSpacingTablet":{"type":"object"},"borderHorizontalSpacingMobile":{"type":"object"},"borderHorizontalSpacingTabletLandscape":{"type":"object"},"borderHorizontalSpacingMobileLandscape":{"type":"object"},"borderHorizontalSpacingLaptop":{"type":"object"},"borderHorizontalSpacingWideScreen":{"type":"object"},"hasHeader":{"type":"boolean","default":true},"headers":{"type":"array","default":[{"title":"Header 1"},{"title":"Header 2"}]},"isEmpty":{"type":"boolean","default":true},"hasFooter":{"type":"boolean","default":true},"showRowPerPage":{"type":"boolean","default":true},"showResult":{"type":"boolean","default":true},"showPaginationControl":{"type":"boolean","default":true},"ShowSearchInput":{"type":"boolean","default":true},"showExportButton":{"type":"boolean","default":true},"showCaption":{"type":"boolean","default":true},"footers":{"type":"array","default":[{"title":"Footer 1"},{"title":"Footer 2"}]},"paddingDesktop":{"type":"object","default":{"top":"10px","right":"10px","bottom":"10px","left":"10px"}},"paddingTablet":{"type":"object"},"paddingMobile":{"type":"object"},"paddingTabletLandscape":{"type":"object"},"paddingMobileLandscape":{"type":"object"},"paddingLaptop":{"type":"object"},"paddingWideScreen":{"type":"object"},"background":{"type":"object"},"border":{"type":"object","default":{"width":"1px","style":"solid","color":"#000"}},"backgroundHover":{"type":"object"},"borderHoverColor":{"type":"string"},"typography":{"type":"object"},"headerTypography":{"type":"object"},"headerColor":{"type":"string"},"headerBackground":{"type":"object"},"headerBorder":{"type":"object"},"headerPaddingDesktop":{"type":"object"},"headerPaddingTablet":{"type":"object"},"headerPaddingMobile":{"type":"object"},"headerPaddingMobileLandscape":{"type":"object"},"headerPaddingTabletLandscape":{"type":"object"},"headerPaddingLaptop":{"type":"object"},"headerPaddingWideScreen":{"type":"object"},"headerBorderRadiusDesktop":{"type":"object"},"headerBorderRadiusTablet":{"type":"object"},"headerBorderRadiusMobile":{"type":"object"},"headerBorderRadiusTabletLandscape":{"type":"object"},"headerBorderRadiusMobileLandscape":{"type":"object"},"headerBorderRadiusLaptop":{"type":"object"},"headerBorderRadiusWideScreen":{"type":"object"},"footerTypography":{"type":"object"},"headerBoxShadow":{"type":"object"},"footerColor":{"type":"string"},"footerBackground":{"type":"object"},"footerBorder":{"type":"object"},"footerPaddingDesktop":{"type":"object"},"footerPaddingTablet":{"type":"object"},"footerPaddingMobile":{"type":"object"},"footerPaddingMobileLandscape":{"type":"object"},"footerPaddingTabletLandscape":{"type":"object"},"footerPaddingLaptop":{"type":"object"},"footerPaddingWideScreen":{"type":"object"},"footerBorderRadiusDesktop":{"type":"object"},"footerBorderRadiusTablet":{"type":"object"},"footerBorderRadiusMobile":{"type":"object"},"footerBorderRadiusTabletLandscape":{"type":"object"},"footerBorderRadiusMobileLandscape":{"type":"object"},"footerBorderRadiusLaptop":{"type":"object"},"footerBorderRadiusWideScreen":{"type":"object"},"alignmentDesktop":{"type":"string","default":"center"},"alignmentTablet":{"type":"string"},"alignmentMobile":{"type":"string"},"cellTypography":{"type":"object"},"cellAlignmentDesktop":{"type":"string"},"cellAlignmentTablet":{"type":"string"},"cellAlignmentMobile":{"type":"string"},"cellAlignmentMobileLandscape":{"type":"string"},"cellAlignmentTabletLandscape":{"type":"string"},"cellAlignmentLaptop":{"type":"string"},"cellAlignmentWideScreen":{"type":"string"},"cellBorder":{"type":"object"},"cellBorderRadiusDesktop":{"type":"object"},"cellBorderRadiusTablet":{"type":"object"},"cellBorderRadiusMobile":{"type":"object"},"cellPaddingDesktop":{"type":"object"},"cellPaddingTablet":{"type":"object"},"cellPaddingMobile":{"type":"object"},"headerAlignmentDesktop":{"type":"string"},"headerAlignmentTablet":{"type":"string"},"headerAlignmentMobile":{"type":"string"},"footerAlignmentDesktop":{"type":"string"},"footerAlignmentTablet":{"type":"string"},"footerAlignmentMobile":{"type":"string"},"footerAlignmentMobileLandscape":{"type":"string"},"footerAlignmentTabletLandscape":{"type":"string"},"footerAlignmentLaptop":{"type":"string"},"footerAlignmentWideScreen":{"type":"string"},"captionTypography":{"type":"object"},"captionColor":{"type":"string"},"captionBackground":{"type":"object"},"captionBorder":{"type":"object"},"captionMarginDesktop":{"type":"object"},"captionMarginTablet":{"type":"object"},"captionMarginMobile":{"type":"object"},"captionMarginMobileLandscape":{"type":"object"},"captionMarginTabletLandscape":{"type":"object"},"captionMarginLaptop":{"type":"object"},"captionMarginWideScreen":{"type":"object"},"captionPaddingDesktop":{"type":"object"},"captionPaddingTablet":{"type":"object"},"captionPaddingMobile":{"type":"object"},"captionBorderRadiusDesktop":{"type":"object"},"captionBorderRadiusTablet":{"type":"object"},"captionBorderRadiusMobile":{"type":"object"},"captionBorderRadiusTabletLandscape":{"type":"object"},"captionBorderRadiusMobileLandscape":{"type":"object"},"captionBorderRadiusLaptop":{"type":"object"},"captionBorderRadiusWideScreen":{"type":"object"},"color":{"type":"string"},"cellColor":{"type":"string"},"cellBackground":{"type":"object"},"tableBuilderBoxShadow":{"type":"object"},"columnItems":{"type":"array"},"variationType":{"type":"string"},"enableSorting":{"type":"boolean","default":true},"mergeTableCell":{"type":"object"}}}'),c=[{attributes:i.uK,save(e){const{attributes:t}=e,{caption:l,headers:r,footers:a,hasHeader:i,hasFooter:c,isEmpty:s}=t,d=n.useBlockProps.save({"data-settings":JSON.stringify(t)}),u=n.useInnerBlocksProps.save({className:"gkit-table__body"}),b=r.map(((e,t)=>(0,o.createElement)("th",{key:t,className:"gkit-table__header-content"},(0,o.createElement)(n.RichText.Content,{identifier:`header-${t}`,tagName:"div",value:e.title})))),m=a.map(((e,t)=>(0,o.createElement)("td",{key:t,className:"gkit-table__footer-content"},(0,o.createElement)(n.RichText.Content,{identifier:`footer-${t}`,tagName:"div",value:e.title}))));return(0,o.createElement)("figure",{...d},!s&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("table",{className:"gkit-table"},i&&(0,o.createElement)("thead",{className:"gkit-table__header"},(0,o.createElement)("tr",null,b)),(0,o.createElement)("tbody",{...u}),c&&(0,o.createElement)("tfoot",{className:"gkit-table__footer"},(0,o.createElement)("tr",null,m))),(0,o.createElement)(n.RichText.Content,{identifier:"caption",tagName:"figcaption",className:"gkit-table__caption",value:l})))}}],s=window.wp.element,d=window.wp.primitives;var u=l(848);const b=(0,u.jsx)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(d.Path,{d:"M13 5.5H4V4h9v1.5Zm7 7H4V11h16v1.5Zm-7 7H4V18h9v1.5Z"})}),m=(0,u.jsx)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(d.Path,{d:"M7.5 5.5h9V4h-9v1.5Zm-3.5 7h16V11H4v1.5Zm3.5 7h9V18h-9v1.5Z"})}),p=(0,u.jsx)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(d.Path,{d:"M11.111 5.5H20V4h-8.889v1.5ZM4 12.5h16V11H4v1.5Zm7.111 7H20V18h-8.889v1.5Z"})}),g=window.wp.data,h=[{category:"Cell Options",options:[{label:(0,a.__)("Text Color","table-builder-block"),value:"cellTextColor"},{label:(0,a.__)("Background Color","table-builder-block"),value:"cellBackgroundColor"},{label:(0,a.__)("CSS Class","table-builder-block"),value:"cellCssClass"},{label:(0,a.__)("Content","table-builder-block"),value:"cellContent"}]},{category:"Row Options",options:[{label:(0,a.__)("Text Color","table-builder-block"),value:"rowTextColor"},{label:(0,a.__)("Background Color","table-builder-block"),value:"rowBackgroundColor"},{label:(0,a.__)("CSS Class","table-builder-block"),value:"rowCssClass"}]},{category:"Column Options",options:[{label:(0,a.__)("Text Color","table-builder-block"),value:"columnTextColor"},{label:(0,a.__)("Background Color","table-builder-block"),value:"columnBackgroundColor"},{label:(0,a.__)("CSS Class","table-builder-block"),value:"columnCssClass"}]}],f=[{label:(0,a.__)("Is Equal To","table-builder-block"),value:"equal"},{label:(0,a.__)("Not Equal","table-builder-block"),value:"notEqual"},{label:(0,a.__)("Contains","table-builder-block"),value:"contains"},{label:(0,a.__)("Does Not Contain","table-builder-block"),value:"notContains"}],y=window.wp.components,v=e=>{if(!e||"string"!=typeof e)return null;const t=e.trim();return t.includes(",")?t.split(",")[1]?.trim():t},C={equal:(e,t)=>e===t,notEqual:(e,t)=>e!==t,contains:(e,t)=>e.includes(t),notContains:(e,t)=>!e.includes(t),greaterThan:(e,t)=>isNaN(e)||isNaN(t)?e>t:parseFloat(e)>parseFloat(t),lessThan:(e,t)=>isNaN(e)||isNaN(t)?e<t:parseFloat(e)<parseFloat(t),greaterThanOrEqual:(e,t)=>isNaN(e)||isNaN(t)?e>=t:parseFloat(e)>=parseFloat(t),lessThanOrEqual:(e,t)=>isNaN(e)||isNaN(t)?e<=t:parseFloat(e)<=parseFloat(t)},k=e=>{if(!e?.element||!e?.data)return;const t=(()=>{const e=document.querySelector('iframe[name="editor-canvas"]')||document.querySelector("iframe")||document.querySelector(".block-editor-iframe__container iframe");return e?.contentDocument?e.contentDocument:document})().querySelector(`.${e.element}`)||document.querySelector(`.${e.element}`);if(!t)return;const l=Array.from(t.querySelectorAll("table")),o=[...new Set([...l])];o.length&&o.forEach((t=>{(e=>{e.querySelectorAll("[data-conditional-formatting='true']").forEach((e=>{["color","backgroundColor","background","backgroundSize"].forEach((t=>{e.style[t]=""}));const t=e.getAttribute("data-previous-class");t&&(e.classList.remove(t),e.removeAttribute("data-previous-class")),e.removeAttribute("data-conditional-formatting")}))})(t);const l=(e=>{const t=new Map,l=e.querySelector("tr:first-child");return l&&l.querySelectorAll("th, td").forEach(((e,l)=>{const o=e.textContent.trim().toLowerCase().replace(/\s+/g,"");t.set(o,l)})),t})(t);e.data.forEach((e=>{((e,t,l)=>{const{columnKey:o,comparisonType:r="equal",comparisonValue:a="",formatAction:n,formatTextColor:i,formatBackground:c,formatCssClass:s}=t;if(!o||!n)return;const d=l.get(o);if(void 0===d)return;const u=Array.from(e.querySelectorAll("tr")).slice(1),b=a.toString().trim().toLowerCase(),m=n.startsWith("column"),p=n.startsWith("row");u.forEach((e=>{const t=e.querySelectorAll("td, th"),l=t[d];if(!l)return;const o=l.textContent.trim().toLowerCase(),a=C[r]?.(o,b);let u=[];m?u=[l]:a&&(u=p?Array.from(t):[l]),u.forEach((e=>{((e,t)=>{const{formatAction:l,formatTextColor:o,formatBackground:r,formatCssClass:a}=t;if(l.includes("TextColor")&&o){const t=v(o);t&&(e.style.color=t)}if(l.includes("BackgroundColor")&&r){const t=(e=>{if(!e)return{background:"",size:""};let t="";return"classic"===e.backgroundType&&e.backgroundColor?t=v(e.backgroundColor)||"":"gradient"===e.backgroundType&&e.gradient&&(t=(e=>{if(!e)return"";if("linear"===e.type){const t=e.angle||0,l=e.stops?.map((e=>`${e.color} ${e.position}%`)).join(", ");return`linear-gradient(${t}deg, ${l})`}if("radial"===e.type){const t=e.stops?.map((e=>`${e.color} ${e.position}%`)).join(", ");return`radial-gradient(circle, ${t})`}return""})(e.gradient)),{background:t,size:""}})(r);t.background&&(e.style.background=t.background),t.size&&(e.style.backgroundSize=t.size)}if(l.includes("CssClass")&&a){const t="string"!=typeof(n=a)?"":n.toLowerCase().trim().replace(/[^\w-]+/g,"-").replace(/^-+|-+$/g,"").replace(/-+/g,"-").replace(/script/g,"");if(t){const l=e.getAttribute("data-previous-class");l&&e.classList.remove(l),e.classList.add(t),e.setAttribute("data-previous-class",t)}}var n;e.setAttribute("data-conditional-formatting","true")})(e,{formatAction:n,formatTextColor:i,formatBackground:c,formatCssClass:s})}))}))})(t,e,l)}))}))},S=({attributes:e,setAttributes:t,clientId:l})=>{const{GkitColor:n,GkitPanelBody:i,GkitBackgrounGroup:c,GkitRepeater:d,GkitSelect:u,GkitText:b}=window?.tableBuilder?.components||{},{headers:m,tableConditionalFormat:p=[],tableDataset:v}=e,C=(0,s.useRef)(null),S=(0,s.useRef)(null),E=(0,s.useRef)({data:p,element:e?.blockClass});(0,s.useEffect)((()=>{E.current={data:p,element:e?.blockClass}}),[p,e?.blockClass]);const _=(()=>{const t=v?.tableHeader||m||e?.PostData?.tableHeader;return t?.map((e=>{const t=("string"==typeof e?e:e?.title||"").trim(),l=t.toLowerCase().replace(/\s+/g,"");return{label:t,value:l}}))||[]})();S.current||(S.current=(()=>{let e;return function(...t){clearTimeout(e),e=setTimeout((()=>{clearTimeout(e),(()=>{k(E.current)})(...t)}),100)}})()),(0,s.useEffect)((()=>{if(!e?.blockClass)return;const t=document.querySelector('iframe[name="editor-canvas"]')||document.querySelector("iframe"),l=(t?.contentDocument||t?.contentWindow?.document||document).querySelector(`.${e.blockClass}`);return l?(S.current(),C.current=new MutationObserver((e=>{let t=!1;e.forEach((e=>{"childList"===e.type&&Array.from(e.addedNodes).some((e=>1===e.nodeType&&("TR"===e.tagName||"TD"===e.tagName||"TH"===e.tagName||e.querySelector?.("tr, td, th"))))&&(t=!0),"attributes"===e.type&&["class","data-freeze","data-frozen"].includes(e.attributeName)&&(t=!0)})),t&&S.current()})),C.current.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","data-freeze","data-frozen"]}),()=>{C.current&&(C.current.disconnect(),C.current=null)}):void 0}),[e?.blockClass]),(0,s.useEffect)((()=>{p?.length>0&&S.current()}),[JSON.stringify(p)]);const w=(e=>{const t=(0,g.useSelect)((e=>{const{getSelectedBlockClientId:t,getBlock:l}=e("core/block-editor"),o=t(),r=o?l(o):null;return"tablebuilder/data-table"===r?.name||"tablebuilder/post-table"===r?.name}),[]);return(0,s.useMemo)((()=>e.map((e=>({...e,options:e.options.filter((e=>!("cellContent"===e.value&&t)))})))),[e,t])})(h);return(0,o.createElement)(i,{title:(0,a.__)("Conditional Formatting","table-builder-block"),initialOpen:!1},(0,o.createElement)(d,{onChange:e=>t({tableConditionalFormat:e}),itemLabelName:"columnKey",repeaterFields:p,isClone:!1},(0,o.createElement)(u,{label:(0,a.__)("Target Column","table-builder-block"),name:"columnKey",options:_,default:_[0]?.value||""}),(0,o.createElement)(u,{label:(0,a.__)("Condition Type","table-builder-block"),name:"comparisonType",options:f,conditionalShow:!1,condition:{name:"columnKey",value:""},default:"equal"}),(0,o.createElement)(b,{label:(0,a.__)("Comparison Value","table-builder-block"),placeholder:(0,a.__)("Enter comparison value","table-builder-block"),name:"comparisonValue",labelBlock:"block",conditionType:"or",condition:f.map((({value:e})=>({name:"comparisonType",value:e})))}),(0,o.createElement)(u,{label:(0,a.__)("Apply Formatting","table-builder-block"),name:"formatAction",children:w.map(((e,t)=>(0,o.createElement)("optgroup",{key:t,label:(0,a.__)(e.category,"table-builder-block")},e.options.map(((e,t)=>(0,o.createElement)("option",{key:t,value:e.value},e.label)))))),conditionalShow:!1,condition:{name:"comparisonValue",value:""},default:"cellTextColor"}),(0,o.createElement)(b,{label:(0,a.__)("Replace Text","table-builder-block"),placeholder:(0,a.__)("Enter Value","table-builder-block"),name:"formatText",labelBlock:"block",conditionType:"or",condition:[{name:"formatAction",value:"cellContent"}]}),(0,o.createElement)(y.Button,{variant:"primary",onClick:()=>{const e=(0,g.select)("core/block-editor").getBlocks().filter((e=>"tablebuilder/table-builder"===e.name));p.forEach((({columnKey:t,comparisonValue:l,formatAction:o,formatText:a})=>{if(!t||!o.includes("Content")||!a)return;const n=m?.findIndex((({title:e})=>e?.trim().toLowerCase().replace(/\s+/g,"")===t));-1!==n&&e.forEach((e=>{e.innerBlocks.forEach((e=>{if("tablebuilder/table-builder-row"!==e.name)return;const t=e.innerBlocks[n];if("tablebuilder/table-builder-item"!==t?.name)return;const o=t.innerBlocks.map((e=>{const t=e.attributes?.content?.text||e.attributes?.content;return t?.toString().trim().toLowerCase()===l?.toString().trim().toLowerCase()?(0,r.createBlock)(e.name,{...e.attributes,content:a}):e}));(0,g.dispatch)("core/block-editor").replaceInnerBlocks(t.clientId,o,!1)}))}))}))},className:"table-builder-replace-button",style:{display:"flex",justifyContent:"center",alignItems:"center",background:"#3B67FE",color:"#fff",padding:"10px",borderRadius:"4px",fontWeight:500,width:"100%",marginBottom:"15px"},condition:[{name:"formatAction",value:"cellContent"}]},"Replace"),(0,o.createElement)(b,{label:(0,a.__)("CSS Class","table-builder-block"),placeholder:(0,a.__)("Enter CSS class name","table-builder-block"),name:"formatCssClass",labelBlock:"block",conditionType:"or",condition:[{name:"formatAction",value:"cellCssClass"},{name:"formatAction",value:"rowCssClass"},{name:"formatAction",value:"columnCssClass"}]}),(0,o.createElement)(c,{label:(0,a.__)("Background Color","table-builder-block"),name:"formatBackground",exclude:{video:!0,image:!0},conditionType:"or",condition:[{name:"formatAction",value:"cellBackgroundColor"},{name:"formatAction",value:"rowBackgroundColor"},{name:"formatAction",value:"columnBackgroundColor"}]}),(0,o.createElement)(n,{label:(0,a.__)("Text Color","table-builder-block"),name:"formatTextColor",conditionType:"or",condition:[{name:"formatAction",value:"cellTextColor"},{name:"formatAction",value:"rowTextColor"},{name:"formatAction",value:"columnTextColor"}]})))},E=({freezeRows:e=0,freezeColumns:t=0,freezeWarning:l="",setFreezeWarning:r,freezeSettings:a={}})=>{const n=()=>{const{from:e,to:t}=a?.leftFreeze||{};return e>0||t>0},i=()=>{const{from:e,to:t}=a?.rightFreeze||{};return e>0||t>0},c=e>0||t>0||a?.fixedHeader||a?.fixedColumns&&(n()||i()),s=(e,t)=>e||t?e<=0&&t<=0?null:e&&!t?`Column ${e}`:!e&&t?`Column ${t}`:e===t?`Column ${e}`:`Columns ${e} to ${t}`:null;return(0,o.createElement)("div",{className:"freeze-instruction"},l&&(0,o.createElement)("div",{className:"freeze-warning"},(0,o.createElement)("span",{className:"freeze-warning-text"},l),(0,o.createElement)(y.Button,{variant:"link",onClick:()=>r(""),className:"freeze-warning-close"},"√ó")),c&&(()=>{const e=[];if(a?.fixedHeader&&e.push((0,o.createElement)("li",{key:"header"},"Freeze Header: Enabled")),a?.fixedColumns){if(n()){const t=s(a.leftFreeze?.from,a.leftFreeze?.to);t&&e.push((0,o.createElement)("li",{key:"left"},"Left: ",t," Selected"))}if(i()){const t=s(a.rightFreeze?.from,a.rightFreeze?.to);t&&e.push((0,o.createElement)("li",{key:"right"},"Right: ",t," Selected"))}}return e.length>0?(0,o.createElement)("div",{className:"freeze-current-status"},(0,o.createElement)("strong",null,"Current Freeze:"),(0,o.createElement)("ul",{className:"freeze-status-list"},e)):null})())},_=({attributes:e,setAttributes:t,setFreezePopOverOpen:l,freezerRef:r})=>{const a=(()=>{const t=e?.freezeSettings;return t?{enableFixedHeader:t.fixedHeader||!1,enableFixedColumns:t.fixedColumns||!1,leftRange:{from:t.leftFreeze?.from>0?String(t.leftFreeze.from):"",to:t.leftFreeze?.to>0?String(t.leftFreeze.to):""},rightRange:{from:t.rightFreeze?.from>0?String(t.rightFreeze.from):"",to:t.rightFreeze?.to>0?String(t.rightFreeze.to):""}}:{enableFixedHeader:!1,enableFixedColumns:!1,leftRange:{from:"",to:""},rightRange:{from:"",to:""}}})(),[n,i]=(0,s.useState)(a.enableFixedHeader),[c,d]=(0,s.useState)(a.enableFixedColumns),[u,b]=(0,s.useState)(a.leftRange),[m,p]=(0,s.useState)(a.rightRange),g=e?.columnCount||0,h=(0,s.useMemo)((()=>Array.from({length:g},((e,t)=>({label:`Column ${t+1}`,value:String(t+1)})))),[g]),f=(0,s.useMemo)((()=>{const e=parseInt(m.from||"0");return h.filter((t=>0===e||parseInt(t.value)<e))}),[h,m.from]),v=(0,s.useMemo)((()=>{const e=parseInt(u.to||u.from||"0");return h.filter((t=>parseInt(t.value)>e))}),[h,u]),C=()=>l(!1),k=(0,s.useCallback)((()=>({fixedHeader:n,fixedColumns:c,leftFreeze:{from:parseInt(u.from)||0,to:parseInt(u.to||u.from)||0},rightFreeze:{from:parseInt(m.from)||0,to:parseInt(m.to||m.from)||0}})),[n,c,u,m]);(0,s.useEffect)((()=>{const l=k();t({freezeSettings:{...e.freezeSettings||{},...l}}),!n&&r.current&&r.current.updateConfig?.(l),!c&&r.current&&r.current.updateConfig?.(l)}),[n,c]);const S=(e,t,l)=>{("left"===e?b:p)((e=>{const o={...e,[t]:l};return"from"===t&&l&&!e.to&&(o.to=l),o}))},_=({label:e,range:t,rangeType:l,options:r})=>{const a="left"===l?f:v;return(0,o.createElement)("div",{className:"table-freeze-popover__select-range"},(0,o.createElement)("strong",null,e),(0,o.createElement)("div",{className:"table-freeze-popover__select-range-inner"},(0,o.createElement)(y.SelectControl,{label:"Start",value:t.from,options:[{label:"-- Select --",value:""},...a],onChange:e=>S(l,"from",e)}),(0,o.createElement)(y.SelectControl,{label:"End",value:t.to,options:[{label:"-- Select --",value:""},...a.filter((e=>parseInt(e.value)>=parseInt(t.from||"0")))],onChange:e=>S(l,"to",e),disabled:!t.from})))},w=n||c&&(u.from||m.from),x=()=>!(!u.to||!m.from)&&parseInt(u.to)>=parseInt(m.from);return(0,o.createElement)(y.Modal,{title:"Freeze/Unfreeze Table Rows & Columns",onRequestClose:C,className:"table-freeze-popover-modal",size:"large"},(0,o.createElement)("div",{className:"table-freeze-popover-container"},(0,o.createElement)(E,{freezeRows:0,freezeColumns:0,freezeWarning:x()?"Warning: Left and right freeze columns overlap!":"",setFreezeWarning:()=>{},freezeSettings:k()}),(0,o.createElement)("div",{className:"freeze-toggle-controls"},(0,o.createElement)(y.ToggleControl,{label:"Enable Freeze Header",checked:n,onChange:i}),(0,o.createElement)(y.ToggleControl,{label:"Enable Freeze Columns",checked:c,onChange:d})),c&&(0,o.createElement)("div",{className:"freeze-column-ranges"},(0,o.createElement)(_,{label:"Select From Left",range:u,rangeType:"left",options:h}),(0,o.createElement)(_,{label:"Select From Right",range:m,rangeType:"right",options:h})),(0,o.createElement)("div",{className:"table-freeze-popover__button-wrapper"},(0,o.createElement)(y.Button,{variant:"primary",onClick:()=>{const l=k();t({freezeSettings:{...e.freezeSettings||{},...l}}),r.current?.updateConfig?.(l),C()},disabled:!w||x(),className:"table-freeze-popover__button"},"Apply Freeze"),w&&(0,o.createElement)(y.Button,{variant:"secondary",onClick:()=>{i(!1),d(!1),b({from:"",to:""}),p({from:"",to:""}),t({freezeSettings:{...e.freezeSettings||{},fixedHeader:!1,fixedColumns:!1,leftFreeze:{from:0,to:0},rightFreeze:{from:0,to:0}}}),r.current?.destroy(),r.current=null,C()},className:"table-freeze-popover__button table-freeze-popover__clear-button"},"Clear All Freeze"))))},w=e=>{if(!e||"string"!=typeof e)return null;const t=e.trim();if(t.includes(",")){const e=t.split(",");return e.length>1?e[1].trim():null}return t};class x{constructor(e,t={}){if(this.table="string"==typeof e?document.querySelector(e):e,!this.table)throw new Error("Table element not found");this.config={fixedHeader:!1,fixedColumns:!1,leftFreeze:{from:null,to:null},rightFreeze:{from:null,to:null},minColumnWidth:120,...t},this.cellPositions=new Map,this.isInitialized=!1,this.observer=null,this.resizeObserver=null,this.debounceTimer=null,this.init()}init(){this.isInitialized&&this.cleanup(),this.ensureTableWidth(),this.trackCellPositions(),this.applyStyles(),this.observeDOMChanges(),this.observeTableResize(),this.isInitialized=!0}observeDOMChanges(){const e=this.table.querySelector("tbody");e&&(this.observer&&this.observer.disconnect(),this.observer=new MutationObserver((e=>{e.some((e=>"childList"===e.type&&(e.addedNodes.length||e.removedNodes.length)))&&(clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>this.refreshPositions()),100))})),this.observer.observe(e,{childList:!0,subtree:!1}))}observeTableResize(){this.resizeObserver&&this.resizeObserver.disconnect();const e=this.table.closest(".table-freezer-container")||this.setupTableContainer();this.resizeObserver=new ResizeObserver((()=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>this.refreshPositions()),100)})),this.resizeObserver.observe(e)}ensureTableWidth(){const e=this.table.querySelectorAll("tr");if(0===e.length)return;const t=e[0].querySelectorAll("th, td");t.forEach((e=>{const t=this.config.minColumnWidth;e.offsetWidth<t&&(e.style.minWidth=`${t}px`,e.style.width=`${t}px`)})),this.table.style.minWidth=t.length*this.config.minColumnWidth+"px"}trackCellPositions(){const e=this.table.querySelectorAll("tr");this.cellPositions.clear();const t=[];e.forEach(((e,l)=>{const o=e.querySelectorAll("th, td");let r=0;o.forEach(((e,o)=>{const a=e.getBoundingClientRect().width;t.push({cell:e,rowIndex:l,cellIndex:o,left:r,width:a}),r+=a}))})),t.forEach((({cell:e,rowIndex:t,cellIndex:l,left:o,width:r})=>{const a=`${t}-${l}`;this.cellPositions.set(a,{left:o,width:r,rowIndex:t,cellIndex:l}),e.setAttribute("data-row-index",t),e.setAttribute("data-cell-index",l),e.setAttribute("data-left-position",o),e.setAttribute("data-cell-width",r)}))}applyStyles(){this.setupTableContainer(),this.config.fixedColumns&&(null!==this.config.leftFreeze.from&&null!==this.config.leftFreeze.to&&this.applyLeftFreeze(),null!==this.config.rightFreeze.from&&null!==this.config.rightFreeze.to&&this.applyRightFreeze()),this.config.fixedHeader&&this.applyFixedHeader()}setupTableContainer(){let e=this.table.closest(".table-freezer-container");if(!e){const t=document.createElement("div");t.className="table-freezer-container",t.style.cssText="\n                overflow: auto;\n                position: relative;\n                max-width: 100%;\n                max-height: 500px;\n                border: 1px solid #dee2e6;\n            ",this.table.parentNode.insertBefore(t,this.table),t.appendChild(this.table),e=t}return this.table.style.cssText+="\n            border-collapse: separate;\n            border-spacing: 0;\n            position: relative;\n        ",e}applyFixedHeader(){const e=this.table.querySelector("thead");e&&(this.config.headerBgColor&&(e.style.backgroundColor=w(this.config.headerBgColor)),this.config.headerColor&&(e.style.color=w(this.config.headerColor)),e.style.cssText+="\n            position: sticky;\n            top: 0;\n            z-index: 20;\n        ",e.setAttribute("data-frozen","header"))}clearFrozenColumns(e="left"){this.table.querySelectorAll(`[data-frozen="${e}"]`).forEach((e=>{e.removeAttribute("data-frozen"),e.removeAttribute("data-freeze-position"),e.style.position="",e.style.left="",e.style.right="",e.style.zIndex="",e.hasAttribute("data-conditional-formatting")||(e.style.backgroundColor="",e.style.color="")}))}applyFrozenCellStyles(e,{position:t,left:l,right:o,zIndex:r,bgColor:a,color:n}){e.style.position="sticky",e.style.zIndex=r,"left"===t?(e.style.left=`${Math.round(l)}px`,e.setAttribute("data-freeze-position",Math.round(l))):(e.style.right=`${Math.round(o)}px`,e.setAttribute("data-freeze-position",Math.round(o))),e.hasAttribute("data-conditional-formatting")||(a&&(e.style.backgroundColor=w(a)),n&&(e.style.color=w(n))),e.setAttribute("data-frozen",t)}applyLeftFreeze(){let{from:e,to:t}=this.config.leftFreeze;if(null===e||null===t)return;t<e&&(t=e),this.clearFrozenColumns("left");let l=0;for(let o=e-1;o<t;o++){const e=this.table.querySelectorAll(`[data-cell-index="${o}"]`);if(!e.length)continue;e.forEach((e=>{const t=0===parseInt(e.getAttribute("data-row-index"))&&this.config.fixedHeader?20:15;this.applyFrozenCellStyles(e,{position:"left",left:l,zIndex:t,bgColor:this.config.leftColumnBgColor,color:this.config.leftColumnColor})}));const t=this.table.querySelector(`[data-cell-index="${o}"]`);t&&(l+=t.getBoundingClientRect().width)}}applyRightFreeze(){let{from:e,to:t}=this.config.rightFreeze;if(null===e||null===t)return;t<e&&(t=e),this.clearFrozenColumns("right");let l=0;for(let o=t-1;o>=e-1;o--){const e=this.table.querySelectorAll(`[data-cell-index="${o}"]`);if(!e.length)continue;e.forEach((e=>{const t=0===parseInt(e.getAttribute("data-row-index"))&&this.config.fixedHeader?20:15;this.applyFrozenCellStyles(e,{position:"right",right:l,zIndex:t,bgColor:this.config.rightColumnBgColor,color:this.config.rightColumnColor})}));const t=this.table.querySelector(`[data-cell-index="${o}"]`);t&&(l+=t.getBoundingClientRect().width)}}updateConfig(e){this.config={...this.config,...e},this.refreshPositions()}cleanup(){["left","right"].forEach((e=>this.clearFrozenColumns(e))),this.table.querySelectorAll("thead, tr, th, td").forEach((e=>{["data-frozen","data-freeze-position","data-row-index","data-cell-index","data-left-position","data-cell-width"].forEach((t=>e.removeAttribute(t))),"THEAD"===e.tagName||"TH"===e.tagName?(e.style.backgroundColor="",e.style.color=""):e.hasAttribute("data-conditional-formatting")||(e.style.position="",e.style.left="",e.style.right="",e.style.top="",e.style.zIndex="")})),this.table.style.position="",this.cellPositions.clear()}destroy(){this.cleanup(),this.observer&&this.observer.disconnect(),this.resizeObserver&&this.resizeObserver.disconnect(),clearTimeout(this.debounceTimer);const e=this.table.closest(".table-freezer-container");e&&e.parentNode&&(e.parentNode.insertBefore(this.table,e),e.remove()),this.isInitialized=!1}getCellPosition(e,t){return this.cellPositions.get(`${e}-${t}`)}refreshPositions(){this.trackCellPositions(),this.applyStyles()}}const T=({attributes:e,setAttributes:t,clientId:l})=>{const{GkitPanelBody:r,GkitColor:n,GkitSwitcher:i,GkitTabs:c}=window?.tableBuilder?.components||{},{freezeSettings:d}=e,[u,b]=(0,s.useState)(!1),m=(0,s.useRef)(null),p=document.querySelector('iframe[name="editor-canvas"]')||document.querySelector("iframe"),g=p?.contentDocument||p?.contentWindow?.document,h=(()=>{if(!g||!l)return null;const e=g.querySelector(`[data-block="${l}"]`)||g.querySelector(`#block-${l}`)||g.querySelector(`.wp-block[data-block="${l}"]`);return e?e.querySelector("table"):null})();return(0,s.useEffect)((()=>{h&&(d&&e?.enableFreeze?(m.current?.destroy(),m.current=new x(h,d)):(m.current?.destroy(),m.current=null))}),[d,h,e?.enableFreeze]),(0,o.createElement)(r,{title:(0,a.__)("Freeze Table","table-builder-block"),initialOpen:!1},(0,o.createElement)(i,{label:(0,a.__)("Enable Freeze","table-builder-block"),value:e?.enableFreeze,onChange:e=>t({enableFreeze:e})}),e?.enableFreeze&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(y.Button,{variant:"primary",onClick:()=>b((e=>!e)),className:"table-builder-Freeze-button",style:{display:"flex",justifyContent:"center",alignItems:"center",background:"#3B67FE",color:"#fff",padding:"10px",borderRadius:"4px",fontWeight:500,width:"100%",marginBottom:"15px"}},"Freeze Settings"),(0,o.createElement)(y.__experimentalHeading,null,(0,a.__)("Freeze Header","table-builder-block")),(0,o.createElement)(n,{label:(0,a.__)("Color","table-builder-block"),value:d?.headerColor,onChange:e=>t({freezeSettings:{...d,headerColor:e}})}),(0,o.createElement)(n,{label:(0,a.__)("Background","table-builder-block"),value:d?.headerBgColor,onChange:e=>t({freezeSettings:{...d,headerBgColor:e}})}),(0,o.createElement)(y.__experimentalDivider,null),(0,o.createElement)(y.__experimentalHeading,null,(0,a.__)("Freeze Column","table-builder-block")),(0,o.createElement)(c,{type:"normal",tabs:[{name:"left-tab",title:(0,a.__)("Left","table-builder-block")},{name:"right-tab",title:(0,a.__)("Right","table-builder-block")}]},(e=>"left-tab"===e.name?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(n,{label:(0,a.__)("Color","table-builder-block"),value:d?.leftColumnColor,onChange:e=>t({freezeSettings:{...d,leftColumnColor:e}})}),(0,o.createElement)(n,{label:(0,a.__)("Background","table-builder-block"),value:d?.leftColumnBgColor,onChange:e=>t({freezeSettings:{...d,leftColumnBgColor:e}})})):"right-tab"===e.name?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(n,{label:(0,a.__)("Background","table-builder-block"),value:d?.rightColumnColor,onChange:e=>t({freezeSettings:{...d,rightColumnColor:e}})}),(0,o.createElement)(n,{label:(0,a.__)("Background","table-builder-block"),value:d?.rightColumnBgColor,onChange:e=>t({freezeSettings:{...d,rightColumnBgColor:e}})})):void 0))),u&&(0,o.createElement)(_,{attributes:e,setAttributes:t,setFreezePopOverOpen:b,freezerRef:m}))},B=(0,s.memo)((({attributes:e,setAttributes:t,device:l,advancedControl:r,clientId:i})=>{const{GkitBoxShadow:c,GkitColor:s,GkitPanelBody:d,GkitResponsive:u,GkitTabs:g,GkitBackgrounGroup:h,GkitSlider:f,GkitChoose:v,GkitBoxControl:C,GkitBorderControl:k,GkitSwitcher:E,GkitTypography:_,AdvancedColumnStyle:w,HeaderStyle:x,CaptionStyle:B}=window?.tableBuilder?.components,{gkitResponsiveValue:z,responsiveHelper:A,useFontFamilyinBlock:M,useProActive:F,useTableFreeInitialization:N}=window?.tableBuilder?.helpers,j=e?.mergeTableCell&&Object.values(e?.mergeTableCell).some((e=>!0===e.hidden)),$=F();return M([e?.headerTypography,e?.footerTypography,e?.typography,e?.captionTypography]),N(e,$),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(n.InspectorControls,null,(0,o.createElement)(g,{type:"top-level",tabs:[{name:"content",title:(0,a.__)("Content","table-builder-block")},{name:"style",title:(0,a.__)("Style","table-builder-block")},{name:"advanced",title:(0,a.__)("Advanced","table-builder-block")}]},(n=>{switch(n.name){case"content":return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(d,{title:(0,a.__)("Settings","table-builder-block"),initialOpen:!0},(0,o.createElement)(E,{label:(0,a.__)("Enable Header","table-builder-block"),value:e?.hasHeader,onChange:e=>t({hasHeader:e}),help:!e?.hasHeader&&(0,o.createElement)("span",{className:"table-builder-block__notice"},(0,a.__)("Sort & duplicate columns not work without header","table-builder-block"))}),(0,o.createElement)(E,{label:(0,a.__)("Enable Footer","table-builder-block"),value:e?.hasFooter,onChange:e=>t({hasFooter:e})}),(0,o.createElement)(E,{label:(0,a.__)("Enable Sort","table-builder-block"),value:!!$&&e?.enableSorting,onChange:e=>t({enableSorting:e}),disabled:!$,help:$?!0!==j?(0,o.createElement)("span",{className:"table-builder-block__notice"},(0,a.__)("Sorting work at frontend","table-builder-block")):(0,o.createElement)("span",{className:"table-builder-block__notice"},(0,a.__)("Merged cells detected. Please disable sorting to prevent layout issues.","table-builder-block")):(0,a.__)("Pro Feature","table-builder-block")}),(0,o.createElement)(E,{label:(0,a.__)("Fixed width table cells","table-builder-block"),value:e?.hasFixedLayout,onChange:e=>t({hasFixedLayout:e})}),(0,o.createElement)(E,{label:(0,a.__)("Border Collapse","table-builder-block"),value:e?.hasBorderCollaps,onChange:e=>t({hasBorderCollaps:e})}),!e?.hasBorderCollaps&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(u,null,(0,o.createElement)(f,{label:(0,a.__)("Vertical Spacing","table-builder-block"),value:z(e,"borderVerticalSpacing",l),onChange:e=>A("borderVerticalSpacing",e,l,t),sizeUnits:["px","em"],range:{min:0,max:100}})),(0,o.createElement)(u,null,(0,o.createElement)(f,{label:(0,a.__)("Horizontal Spacing","table-builder-block"),value:z(e,"borderHorizontalSpacing",l),onChange:e=>A("borderHorizontalSpacing",e,l,t),sizeUnits:["px","em"],range:{min:0,max:100}}))),(0,o.createElement)(E,{label:(0,a.__)("Enable Caption","table-builder-block"),value:e?.showCaption,onChange:e=>t({showCaption:e})}),e?.showCaption&&(0,o.createElement)(v,{label:(0,a.__)("Caption Position","table-builder-block"),value:e?.captionPosition,onChange:e=>t({captionPosition:e}),isToggle:!1,options:[{label:(0,a.__)("Top","table-builder-block"),value:"top"},{label:(0,a.__)("Bottom","table-builder-block"),value:"bottom"}]})));case"style":return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(d,{title:(0,a.__)("Common","table-builder-block"),initialOpen:!0},(0,o.createElement)(u,null,(0,o.createElement)(v,{label:(0,a.__)("Alignment","table-builder-block"),value:z(e,"alignment",l),options:[{label:"Left",value:"left",icon:b},{label:"Center",value:"center",icon:m},{label:"Right",value:"right",icon:p}],onChange:e=>A("alignment",e,l,t)})),(0,o.createElement)(_,{label:(0,a.__)("Typography","table-builder-block"),onChange:e=>t({typography:e}),value:e?.typography}),(0,o.createElement)(s,{label:(0,a.__)("Color","table-builder-block"),onChange:e=>t({color:e}),value:e?.color}),(0,o.createElement)(h,{label:(0,a.__)("Background","table-builder-block"),onChange:e=>t({background:e}),value:e?.background,exclude:{video:!0,image:!0}}),(0,o.createElement)(k,{label:(0,a.__)("Border","table-builder-block"),value:e.border,onChange:e=>t({border:e})}),(0,o.createElement)(c,{label:(0,a.__)("Box Shadow","table-builder-block"),value:e?.tableBuilderBoxShadow,onChange:e=>t({tableBuilderBoxShadow:e})}),(0,o.createElement)(u,null,(0,o.createElement)(C,{label:(0,a.__)("Padding","table-builder-block"),values:z(e,"padding",l),onChange:e=>A("padding",e,l,t)}))),e.hasHeader&&(0,o.createElement)(x,{attributes:e,setAttributes:t,device:l}),(0,o.createElement)(w,{attributes:e,setAttributes:t,columnItems:"columnItems",header:e?.headers}),e.hasFooter&&(0,o.createElement)(d,{title:(0,a.__)("Footer","table-builder-block")},(0,o.createElement)(u,null,(0,o.createElement)(v,{label:(0,a.__)("Alignment","table-builder-block"),value:z(e,"footerAlignment",l),options:[{label:"Left",value:"left",icon:b},{label:"Center",value:"center",icon:m},{label:"Right",value:"right",icon:p}],onChange:e=>A("footerAlignment",e,l,t)})),(0,o.createElement)(_,{label:(0,a.__)("Typography","table-builder-block"),onChange:e=>t({footerTypography:e}),value:e?.footerTypography}),(0,o.createElement)(s,{label:(0,a.__)("Color","table-builder-block"),onChange:e=>t({footerColor:e}),value:e?.footerColor}),(0,o.createElement)(h,{label:(0,a.__)("Background","table-builder-block"),onChange:e=>t({footerBackground:e}),value:e?.footerBackground,exclude:{video:!0,image:!0}}),(0,o.createElement)(k,{label:(0,a.__)("Border","table-builder-block"),value:e.footerBorder,onChange:e=>t({footerBorder:e})}),(0,o.createElement)(u,null,(0,o.createElement)(C,{label:(0,a.__)("Border Radius","table-builder-block"),values:z(e,"footerBorderRadius",l),onChange:e=>A("footerBorderRadius",e,l,t)})),(0,o.createElement)(u,null,(0,o.createElement)(C,{label:(0,a.__)("Padding","table-builder-block"),values:z(e,"footerPadding",l),onChange:e=>A("footerPadding",e,l,t)}))),(0,o.createElement)(d,{title:(0,a.__)("Cells","table-builder-block")},(0,o.createElement)(u,null,(0,o.createElement)(v,{label:(0,a.__)("Alignment","table-builder-block"),value:z(e,"cellAlignment",l),options:[{label:"Left",value:"left",icon:b},{label:"Center",value:"center",icon:m},{label:"Right",value:"right",icon:p}],onChange:e=>A("cellAlignment",e,l,t)})),(0,o.createElement)(_,{label:(0,a.__)("Typography","table-builder-block"),onChange:e=>t({cellTypography:e}),value:e?.cellTypography}),(0,o.createElement)(s,{label:(0,a.__)("Color","table-builder-block"),onChange:e=>t({cellColor:e}),value:e?.cellColor}),(0,o.createElement)(h,{label:(0,a.__)("Background","table-builder-block"),onChange:e=>t({cellBackground:e}),value:e?.cellBackground,exclude:{video:!0,image:!0}}),(0,o.createElement)(k,{label:(0,a.__)("Border","table-builder-block"),value:e.cellBorder,onChange:e=>t({cellBorder:e})}),(0,o.createElement)(u,null,(0,o.createElement)(C,{label:(0,a.__)("Border Radius","table-builder-block"),values:z(e,"cellBorderRadius",l),onChange:e=>A("cellBorderRadius",e,l,t)})),(0,o.createElement)(y.Notice,{status:"warning",isDismissible:!1,className:"table-builder-notice"},(0,a.__)("Border radius only works properly when Border Collapse is disabled","table-builder-block")),(0,o.createElement)(u,null,(0,o.createElement)(C,{label:(0,a.__)("Padding","table-builder-block"),values:z(e,"cellPadding",l),onChange:e=>A("cellPadding",e,l,t)}))),(0,o.createElement)(B,{attributes:e,setAttributes:t,device:l}));case"advanced":return(0,o.createElement)(o.Fragment,null,$&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(T,{attributes:e,setAttributes:t,clientId:i}),(0,o.createElement)(S,{attributes:e,setAttributes:t,clientId:i})),r)}}))))}));class z{constructor(e,t,l,o,r=()=>{},a=()=>{}){this.getModalTable=e,this.getExternalTable=t,this.cells=l||{},this.setAttributes=o,this.onMergeModeChange=r,this.onMergeWarning=a,this.selectedCell=null,this.mergeMode="merge",this.isSelecting=!1,this.startCoords=null,this.invalidSelection=!1,this.focusedCell=null,this.isShiftSelecting=!1}getKey(e,t){return`${e}-${t}`}static assignDataAttributes(e){e&&e.querySelectorAll("tr").forEach(((e,t)=>{Array.from(e.querySelectorAll("td, th")).forEach(((e,l)=>{e.setAttribute("data-row",t),e.setAttribute("data-col",l)}))}))}getSectionType(e){if(!e?.parentElement?.parentElement)return null;const t=e.parentElement.parentElement;return"THEAD"===t.tagName?"thead":"TFOOT"===t.tagName?"tfoot":"tbody"}restoreTableState(){const e=this.getModalTable(),t=this.getExternalTable();e&&t&&(z.assignDataAttributes(e),z.assignDataAttributes(t),Object.keys(this.cells).forEach((l=>{const o=this.cells[l];if(!o)return;const[r,a]=l.split("-").map(Number);[e.querySelector(`[data-row="${r}"][data-col="${a}"]`),t.querySelector(`[data-row="${r}"][data-col="${a}"]`)].forEach((e=>{e&&(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="",o.hidden||"none"===o.display?e.style.display="none":(o.rowSpan>1&&(e.rowSpan=o.rowSpan),o.colSpan>1&&(e.colSpan=o.colSpan)))}))})))}clearSelection(){[this.getModalTable(),this.getExternalTable()].forEach((e=>{e&&e.querySelectorAll(".selected").forEach((e=>e.classList.remove("selected")))})),this.selectedCell=null}handleCellSelection(e){if(!e)return;const t=parseInt(e.dataset.row),l=parseInt(e.dataset.col),o=this.getKey(t,l),r=this.cells[o];this.clearSelection(),e.classList.add("selected");const a=this.getExternalTable()?.querySelector(`[data-row="${t}"][data-col="${l}"]`);a&&a.classList.add("selected"),this.selectedCell={row:t,col:l,element:e},this.focusedCell={row:t,col:l};const n=r&&(r.rowSpan>1||r.colSpan>1)||e.rowSpan>1||e.colSpan>1;this.mergeMode=n?"unmerge":"merge",this.onMergeModeChange(this.mergeMode)}updateSelectionRange(e){if(!this.startCoords||!e)return;const t=this.getModalTable(),l=this.getExternalTable();if(!t||!l)return;const o=t.querySelector(`[data-row="${this.startCoords.row}"][data-col="${this.startCoords.col}"]`);if(!o)return;const r=this.getSectionType(o),a=this.getSectionType(e);this.invalidSelection=r!==a;const n=this.startCoords.row,i=this.startCoords.col,c=parseInt(e.dataset.row),s=parseInt(e.dataset.col),d=Math.min(n,c),u=Math.max(n,c),b=Math.min(i,s),m=Math.max(i,s);this.clearSelection();let p=!1;for(let e=d;e<=u;e++)for(let o=b;o<=m;o++){const a=t.querySelector(`[data-row="${e}"][data-col="${o}"]`),n=l.querySelector(`[data-row="${e}"][data-col="${o}"]`);a&&this.getSectionType(a)===r&&(a.classList.add("selected"),"none"===a.style.display&&(p=!0),n&&n.classList.add("selected"))}this.mergeMode=p?"unmerge":"merge",this.onMergeModeChange(this.mergeMode)}handleMerge(){const e=this.getModalTable(),t=this.getExternalTable();if(!e||!t)return!1;const l=e.querySelectorAll(".selected");return!(l.length<1)&&(1===l.length&&"unmerge"===this.mergeMode?this.unmergeCell():l.length>1&&this.mergeCells(l))}mergeCells(e){if(e.length<2)return!1;const t=this.getSectionType(e[0]);if(!t)return!1;for(let l of e)if(this.getSectionType(l)!==t)return console.warn("Cannot merge cells from different table sections."),!1;const l=Array.from(e).map((e=>({row:parseInt(e.dataset.row),col:parseInt(e.dataset.col),element:e}))),o=l.map((e=>e.row)),r=l.map((e=>e.col)),a=Math.min(...o),n=Math.max(...o),i=Math.min(...r),c=Math.max(...r),s=n-a+1,d=c-i+1,u=l.find((e=>e.row===a&&e.col===i));if(!u)return!1;this.getModalTable();const b=this.getExternalTable(),m={...this.cells};u.element.rowSpan=s,u.element.colSpan=d;const p=b.querySelector(`[data-row="${a}"][data-col="${i}"]`);return p&&(p.rowSpan=s,p.colSpan=d),m[this.getKey(a,i)]={rowSpan:s,colSpan:d,hidden:!1,display:"","data-row":a,"data-col":i},l.forEach((e=>{if(e.element!==u.element){const t=this.getKey(e.row,e.col);e.element.style.display="none";const l=b.querySelector(`[data-row="${e.row}"][data-col="${e.col}"]`);l&&(l.style.display="none"),m[t]={rowSpan:1,colSpan:1,hidden:!0,display:"none","data-row":e.row,"data-col":e.col}}})),this.setAttributes(m),this.clearSelection(),!0}unmergeCell(){if(!this.selectedCell)return!1;const{row:e,col:t,element:l}=this.selectedCell,o=this.getKey(e,t),r=this.cells[o];if(!r)return!1;const a=this.getModalTable(),n=this.getExternalTable(),i={...this.cells},c=r.rowSpan||1,s=r.colSpan||1;l.rowSpan=1,l.colSpan=1;const d=n.querySelector(`[data-row="${e}"][data-col="${t}"]`);d&&(d.rowSpan=1,d.colSpan=1);for(let l=e;l<e+c;l++)for(let e=t;e<t+s;e++){const t=this.getKey(l,e),o=a.querySelector(`[data-row="${l}"][data-col="${e}"]`);o&&(o.style.display="");const r=n.querySelector(`[data-row="${l}"][data-col="${e}"]`);r&&(r.style.display=""),i[t]={rowSpan:1,colSpan:1,hidden:!1,display:"","data-row":l,"data-col":e}}return this.setAttributes(i),this.clearSelection(),!0}handleMouseDown(e){const t=e.target.closest("td, th");t&&(this.isShiftSelecting=e.shiftKey,this.isShiftSelecting&&this.startCoords?this.updateSelectionRange(t):(this.isSelecting=!0,this.invalidSelection=!1,this.startCoords={row:parseInt(t.dataset.row),col:parseInt(t.dataset.col)},this.handleCellSelection(t)))}handleMouseOver(e){if(!this.isSelecting||this.isShiftSelecting)return;const t=e.target.closest("td, th");t&&this.updateSelectionRange(t)}handleMouseUp(){this.isSelecting=!1,this.isShiftSelecting=!1,this.invalidSelection&&(this.clearSelection(),this.mergeMode="merge",this.onMergeModeChange(this.mergeMode),this.onMergeWarning&&requestAnimationFrame((()=>{this.onMergeWarning("Cannot select cells across different table sections (thead, tbody, tfoot).")}))),this.invalidSelection=!1}getMergeMode(){return this.mergeMode}getSelectedCellsCount(){const e=this.getModalTable();return e?e.querySelectorAll(".selected").length:0}moveFocus(e){if(!this.focusedCell){const e=this.getModalTable();if(!e)return;const t=e.querySelector("td, th");return void(t&&(this.focusedCell={row:parseInt(t.dataset.row),col:parseInt(t.dataset.col)},this.handleCellSelection(t)))}const t=this.getModalTable();if(!t)return;let l=this.focusedCell.row,o=this.focusedCell.col;switch(e){case"up":l=Math.max(0,l-1);break;case"down":l+=1;break;case"left":o=Math.max(0,o-1);break;case"right":o+=1}const r=t.querySelector(`[data-row="${l}"][data-col="${o}"]`);r&&"none"!==r.style.display&&(this.handleCellSelection(r),r.scrollIntoView({block:"nearest",inline:"nearest"}))}expandSelection(e){if(!this.startCoords){if(!this.focusedCell)return;this.startCoords={...this.focusedCell}}if(!this.focusedCell)return;const t=this.getModalTable();if(!t)return;let l=this.focusedCell.row,o=this.focusedCell.col;switch(e){case"up":l=Math.max(0,l-1);break;case"down":l+=1;break;case"left":o=Math.max(0,o-1);break;case"right":o+=1}const r=t.querySelector(`[data-row="${l}"][data-col="${o}"]`);r&&"none"!==r.style.display&&(this.focusedCell={row:parseInt(r.dataset.row),col:parseInt(r.dataset.col)},this.updateSelectionRange(r),r.scrollIntoView({block:"nearest",inline:"nearest"}))}clearAllMerges(){const e=this.getModalTable(),t=this.getExternalTable();if(!e||!t)return!1;const l={};return e.querySelectorAll("td, th").forEach((e=>{const o=parseInt(e.dataset.row),r=parseInt(e.dataset.col),a=this.getKey(o,r);e.rowSpan=1,e.colSpan=1,e.style.display="";const n=t.querySelector(`[data-row="${o}"][data-col="${r}"]`);n&&(n.rowSpan=1,n.colSpan=1,n.style.display=""),l[a]={rowSpan:1,colSpan:1,hidden:!1,display:"","data-row":o,"data-col":r}})),this.setAttributes(l),this.clearSelection(),!0}}const A=({mergeMode:e,selectedCount:t,mergeWarning:l,setMergeWarning:r})=>{const a=(0,s.useRef)(null),n="merge"===e,i=n?"Select cells using mouse or keyboard arrows. Keyboard: Hold Shift + use Arrow Keys. Mouse: Hold Shift + use Mouse Cursor to select cells.":'Selected cell is merged. Click "Unmerge Cell" or press Enter/Space to split it back into individual cells.',c=t>0?`${t} cell${1!==t?"s":""} selected`:"No cells selected",d=0===t?"Click any cell to start":"unmerge"===e?"Ready to unmerge":t>1?"Ready to merge":"Select more cells to merge";return(0,s.useEffect)((()=>{if(l&&a.current){a.current.classList.add("table-merge-popover-modal__toast--visible");const e=setTimeout((()=>{r(""),a.current?.classList.remove("table-merge-popover-modal__toast--visible")}),4e3);return()=>clearTimeout(e)}}),[l,r]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"table-merge-popover-modal__instruction"},(0,o.createElement)("div",{className:"table-merge-popover-modal__instruction-container"},(0,o.createElement)("div",{className:"table-merge-popover-modal__instruction-header"},(0,o.createElement)("span",{className:"table-merge-popover-modal__instruction-mode "+(n?"merge-active":"")},n?"üîó Merge Mode":"‚úÇÔ∏è Unmerge Mode"),(0,o.createElement)("span",{className:"table-merge-popover-modal__instruction-status"},c),(0,o.createElement)("span",{className:"table-merge-popover-modal__instruction-actionText "+(t>1&&n?"merge-active":"")},"‚Ä¢ ",d))),(0,o.createElement)("p",{className:"table-merge-popover-modal__instruction-text"},"üí° ",(0,o.createElement)("strong",null,"How to select:")," ",i)),l&&(0,o.createElement)("div",{ref:a,className:"table-merge-popover-modal__toast"},(0,o.createElement)("span",{style:{fontSize:"18px"}},"‚ö†Ô∏è"),(0,o.createElement)("span",null,(0,o.createElement)("strong",null,"Warning:")," ",l)))},M=({attributes:e,setAttributes:t,setMergePopOverOpen:l,isVisible:r,externalTableRef:a})=>{const n=(0,s.useRef)(null),i=(0,s.useRef)(null),[c,d]=(0,s.useState)(""),[u,b]=(0,s.useState)("merge"),[m,p]=(0,s.useState)(0),[g,h]=(0,s.useState)(e.mergeTableCell||{});(0,s.useEffect)((()=>{h(e.mergeTableCell||{})}),[e.mergeTableCell]);const f=()=>i.current,v=()=>a.current,C=()=>{n.current&&(b(n.current.getMergeMode()),p(n.current.getSelectedCellsCount()))},k=()=>{n.current&&n.current.clearSelection(),l(!1)};(0,s.useEffect)((()=>{const e=new z(f,v,g,(e=>{h(e),t({mergeTableCell:e})}),b,(e=>d(e)));n.current=e;const l=f();if(!l)return;const o=t=>{e.handleMouseDown(t),C()},r=t=>{e.handleMouseOver(t),C()},a=t=>{e.handleMouseUp(t),C()};l.addEventListener("mousedown",o),l.addEventListener("mouseover",r),document.addEventListener("mouseup",a);const i=t=>{if(e)if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)){t.preventDefault();const l=t.key.replace("Arrow","").toLowerCase();t.shiftKey?e.expandSelection(l):e.moveFocus(l),C()}else"Enter"===t.key||" "===t.key?(t.preventDefault(),S()):"Escape"===t.key&&(t.preventDefault(),e.clearSelection(),C())};return document.addEventListener("keydown",i),z.assignDataAttributes(l),z.assignDataAttributes(v()),e.restoreTableState(),C(),()=>{l.removeEventListener("mousedown",o),l.removeEventListener("mouseover",r),document.removeEventListener("mouseup",a),document.removeEventListener("keydown",i)}}),[g,t,e.rowCount,e.columnCount]);const S=()=>{n.current&&n.current.handleMerge()&&setTimeout((()=>{k()}),100)};(0,s.useEffect)((()=>{const e=document.querySelector(".components-modal__screen-overlay");e&&(e.style.visibility=r?"visible":"hidden")}),[r]);const E=m>=1&&("unmerge"===u||m>1);return(0,o.createElement)(y.Modal,{title:"Merge/Unmerge Table Cells",onRequestClose:k,size:"fill",className:"table-merge-popover-modal",style:r?{display:"block"}:{display:"none"}},(0,o.createElement)(A,{mergeMode:u,selectedCount:m,mergeWarning:c,setMergeWarning:d}),(0,o.createElement)("div",{className:"table-merge-popover__scrollable-container"},(0,o.createElement)("table",{className:"table-merge-popover",ref:i},e?.hasHeader&&(0,o.createElement)("thead",{className:"table-merge-popover__header"},(0,o.createElement)("tr",null,e?.headers?.map(((e,t)=>(0,o.createElement)("th",{key:t},e.title))))),(0,o.createElement)("tbody",{className:"table-merge-popover__body"},Array.from({length:e?.rowCount||0}).map(((t,l)=>(0,o.createElement)("tr",{key:l},Array.from({length:e?.columnCount||0}).map(((e,t)=>(0,o.createElement)("td",{key:t,"data-row":l,"data-col":t},"Cell ",l+1,"-",t+1))))))),e?.hasFooter&&(0,o.createElement)("tfoot",{className:"table-merge-popover__footer"},(0,o.createElement)("tr",null,e?.footers?.map(((e,t)=>(0,o.createElement)("td",{key:t},e.title))))))),(0,o.createElement)("div",{className:"table-merge-popover__button-wrapper"},(0,o.createElement)("div",{className:"table-merge-popover__shortcuts"},(0,o.createElement)("small",{style:{color:"#666",fontSize:"12px",lineHeight:"1.4"}},(0,o.createElement)("strong",null,"‚å®Ô∏è Keyboard shortcuts:")," Arrow keys to navigate | Shift + Arrows to select | Enter/Space to merge/unmerge | Esc to clear"),(0,o.createElement)("small",{style:{color:"#666",fontSize:"12px",marginTop:"4px",display:"block"}},(0,o.createElement)("strong",null,"üñ±Ô∏è Mouse shortcuts:")," Click & drag to select | Shift + Click to extend selection")),(0,o.createElement)("div",{style:{display:"flex",gap:"8px"}},(0,o.createElement)(y.Button,{variant:"tertiary",onClick:()=>{n.current&&window.confirm("Are you sure you want to clear all merged cells? This action cannot be undone.")&&(n.current.clearAllMerges(),C())},className:"table-merge-popover__clear-button",isDestructive:!0,disabled:!(()=>{const e=g||{};return Object.values(e).some((e=>e&&(e.rowSpan>1||e.colSpan>1||!0===e.hidden)))})()},"Clear All Merges"),(0,o.createElement)(y.Button,{variant:"primary",onClick:S,className:"table-merge-popover__button",disabled:!E},0===m?"Select a cell":1===m&&"unmerge"===u?"Unmerge Cell":m>1?`Merge ${m} Cells`:"Select more cells to merge"))))},F=(0,u.jsx)(d.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)(d.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v3.5h-15V5c0-.3.2-.5.5-.5zm8 5.5h6.5v3.5H13V10zm-1.5 3.5h-7V10h7v3.5zm-7 5.5v-4h7v4.5H5c-.3 0-.5-.2-.5-.5zm14.5.5h-6V15h6.5v4c0 .3-.2.5-.5.5z"})}),N=e=>e.map((e=>wp.blocks.createBlock(e.name,{...e.attributes},e.innerBlocks?.length?N(e.innerBlocks):[]))),j=(e=!1,t=!1)=>{const l=document.createElement("div");if(l.className="column-selection-overlay",l.style.cssText="\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(37, 99, 235, 0.35);\n        border: 2px solid rgba(37, 99, 235, 0.3);\n        pointer-events: none;\n        z-index: 1;\n        border-radius: inherit;\n    ",t&&e){const e=document.createElement("span");e.className="column-indicator-badge",e.textContent="Selected",e.style.cssText="\n            position: absolute;\n            top: 4px;\n            right: 4px;\n            padding: 2px 8px;\n            background: #2563eb;\n            color: white;\n            font-size: 11px;\n            font-weight: 600;\n            border-radius: 4px;\n            pointer-events: none;\n            z-index: 2;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        ",l.appendChild(e)}return l},$=(e,t,l=!0)=>{const o=e?.querySelector("thead"),r=e?.querySelector("tbody"),a=e?.querySelector("tfoot");if(o){const e=o.querySelectorAll("th")[t];if(e)if(l){"static"===window.getComputedStyle(e).position&&(e.style.position="relative");const t=e.querySelector(".column-selection-overlay");t&&t.remove();const l=j(!0,!0);e.appendChild(l)}else{const t=e.querySelector(".column-selection-overlay");t&&t.remove()}}r&&r.querySelectorAll("tr").forEach((e=>{const o=e.querySelectorAll("td, th")[t];if(o)if(l){"static"===window.getComputedStyle(o).position&&(o.style.position="relative");const e=o.querySelector(".column-selection-overlay");e&&e.remove();const t=j(!1);o.appendChild(t)}else{const e=o.querySelector(".column-selection-overlay");e&&e.remove()}})),a&&a.querySelectorAll("tr").forEach((e=>{const o=e.querySelectorAll("td, th")[t];if(o)if(l){"static"===window.getComputedStyle(o).position&&(o.style.position="relative");const e=o.querySelector(".column-selection-overlay");e&&e.remove();const t=j(!0);o.appendChild(t)}else{const e=o.querySelector(".column-selection-overlay");e&&e.remove()}}))};(0,r.registerBlockType)(i.UU,{edit:function({attributes:e,setAttributes:t,clientId:l,advancedControl:r,onReplace:i,isSelected:c}){const{caption:d,rowCount:u,columnCount:b,headers:m,footers:p,hasHeader:h,hasFooter:f,isEmpty:v}=e,{GkitStyle:C,GkitNumber:k,GkitSwitcher:S,TableBuilderPlaceholder:E}=window?.tableBuilder?.components,{useDeviceType:_,useBlockStyles:w,useDeviceList:x,useProActive:T}=window?.tableBuilder?.helpers,z=x(),A=_(),j=Array.from({length:u},(()=>["tablebuilder/table-builder-row"])),R=(0,n.useBlockProps)(),L=(0,s.useRef)(),q=T(),H=(0,g.useSelect)((e=>{const{getBlocksByClientId:t}=e("core/block-editor"),o=t(l)[0];return o?.innerBlocks?.length||0}),[l]),P=(0,s.useRef)(u);(0,s.useEffect)((()=>{H>0&&H!==u&&!v&&P.current!==H&&(P.current=H,t({rowCount:H}))}),[H,u,v,t]);const I=(0,n.useInnerBlocksProps)({className:"gkit-table__body"},{allowedBlocks:["tablebuilder/table-builder-row"],renderAppender:!1,template:j}),O=(e,l,o,r,a)=>{const n=JSON.parse(JSON.stringify(r));n[e][l]=o,t({[a]:n})},V=m.map(((e,t)=>(0,o.createElement)("th",{key:t,className:"gkit-table__header-content"},(0,o.createElement)(n.RichText,{identifier:`header-${t}`,tagName:"div",value:e.title,onChange:e=>O(t,"title",e,m,"headers"),placeholder:"Header"})))),D=p.map(((e,t)=>(0,o.createElement)("td",{key:t,className:"gkit-table__footer-content"},(0,o.createElement)(n.RichText,{identifier:`footer-${t}`,tagName:"div",value:e.title,onChange:e=>O(t,"title",e,p,"footers"),placeholder:"Footer"})))),[W,G]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(q&&L.current&&!v){const e=((e,t)=>{const l=e?.querySelector("thead"),o=e?.querySelector("tbody"),r=e?.querySelector("tfoot");if(!l)return;const a="selected-column",n=()=>{l.querySelectorAll("th").forEach(((t,l)=>{t.classList.remove(a),$(e,l,!1)})),t(null)};o&&o.querySelectorAll("td, th").forEach((e=>{e.addEventListener("focus",n,!0),e.addEventListener("click",(e=>{e.target.closest("thead")||n()}))})),r&&r.querySelectorAll("td, th").forEach((e=>{e.addEventListener("focus",n,!0),e.addEventListener("click",n)})),l.querySelectorAll("th").forEach(((o,r)=>{o.columnClickHandler&&o.removeEventListener("click",o.columnClickHandler),o.columnClickHandler=i=>{i.stopPropagation();const c=o.classList.contains(a),s=l.querySelectorAll("th");c?n():(s.forEach(((t,l)=>{t.classList.remove(a),$(e,l,!1)})),o.classList.add(a),"static"===window.getComputedStyle(o).position&&(o.style.position="relative"),$(e,r,!0),t(r))},o.addEventListener("click",o.columnClickHandler),Object.assign(o.style,{cursor:"pointer",transition:"all 0.2s ease"}),o.addEventListener("mouseenter",(()=>{if(!o.classList.contains(a)){"static"===window.getComputedStyle(o).position&&(o.style.position="relative");const e=o.querySelector(".column-hover-overlay");e&&e.remove();const t=document.createElement("div");t.className="column-hover-overlay",t.style.cssText="\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n                    background-color: rgba(37, 99, 235, 0.05);\n                    pointer-events: none;\n                    z-index: 1;\n                    border-radius: inherit;\n                ",o.appendChild(t)}})),o.addEventListener("mouseleave",(()=>{const e=o.querySelector(".column-hover-overlay");e&&e.remove()})),o.title=`Click to select/deselect column ${r+1}`})),o&&(o.clearSelectionHandler&&o.removeEventListener("click",o.clearSelectionHandler),o.clearSelectionHandler=n,o.addEventListener("click",o.clearSelectionHandler)),r&&(r.clearSelectionHandler&&r.removeEventListener("click",r.clearSelectionHandler),r.clearSelectionHandler=n,r.addEventListener("click",r.clearSelectionHandler))})(L.current,G);return()=>{e&&"function"==typeof e&&e()}}}),[q,L.current,b,v,h]),(0,s.useEffect)((()=>{!c&&null!==W&&L.current&&((e=>{if(!e)return;const t=e.querySelector("thead"),l=e.querySelector("tbody"),o=e.querySelector("tfoot");t&&t.querySelectorAll("th").forEach((e=>{e.classList.remove("selected-column");const t=e.querySelector(".column-selection-overlay");t&&t.remove()})),l&&l.querySelectorAll("td, th").forEach((e=>{const t=e.querySelector(".column-selection-overlay");t&&t.remove()})),o&&o.querySelectorAll("td, th").forEach((e=>{const t=e.querySelector(".column-selection-overlay");t&&t.remove()}))})(L.current),G(null))}),[c,W]);const K=!e?.variationType,U="blank"===e?.variationType,Z=()=>(0,o.createElement)(E,{attributes:e,setAttributes:t,clientId:l,onReplace:i,blockName:"tablebuilder/table-builder"}),[J,Y]=(0,s.useState)(!1),[Q,X]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{const e=setTimeout((()=>X(!1)),0);return()=>clearTimeout(e)}),[]),w(e,t,"blocksCSS",((e,t)=>{const{parseCSS:l,backgroundGenerator:o,getBoxShadowValue:r,getBoxValue:a,getBorderValue:n,getSliderValue:i,getTypographyValue:c,getColor:s,applyStyle:d}=window?.tableBuilder?.helpers,u=e.blockClass;return l([[...d(u,e?.columnItems,e?.headers),{selector:`.${u}`,color:s(e.color),display:"flex","box-shadow":r(e?.tableBuilderBoxShadow),"flex-direction":"top"===e?.captionPosition?"column-reverse":"column"},{selector:`.${u} .gkit-table`,background:o(e?.background).background,"table-layout":e?.hasFixedLayout&&"fixed","border-collapse":e?.hasBorderCollaps&&"collapse",width:"100%"},{selector:`.${u} th, .${u} td`,...n(e?.border)},{selector:`.${u} thead`,color:s(e.headerColor),background:o(e?.headerBackground).background,...n(e?.headerBorder),"box-shadow":r(e?.headerBoxShadow)},{selector:`.${u} thead th`,...n(e?.headerBorder)},{selector:`.${u} tfoot td`,color:s(e.footerColor),background:o(e?.footerBackground).background,...n(e?.footerBorder)},{selector:`.${u} tbody td`,color:s(e.cellColor),...n(e?.cellBorder)},{selector:`.${u} tbody`,background:o(e?.cellBackground).background},{selector:`.${u} .gkit-table__caption`,color:s(e.captionColor),background:o(e?.captionBackground).background,...n(e?.captionBorder)}],t=>[{selector:`.${u}`,"text-align":e[`alignment${t}`],...c(e.typography,t)},{selector:`.${u} .gkit-table`,"-webkit-border-vertical-spacing":!e?.hasBorderCollaps&&i(e?.[`borderVerticalSpacing${t}`]),"-webkit-border-horizontal-spacing":!e?.hasBorderCollaps&&i(e?.[`borderHorizontalSpacing${t}`])},{selector:`.${u} th, .${u} td`,...a(e[`padding${t}`],"padding")},{selector:`.${u} thead`,"text-align":e[`headerAlignment${t}`]},{selector:`.${u} thead th`,...c(e.headerTypography,t),...a(e[`headerPadding${t}`],"padding"),...a(e[`headerBorderRadius${t}`],"border-radius")},{selector:`.${u} tfoot td`,...c(e.footerTypography,t),...a(e[`footerPadding${t}`],"padding"),...a(e[`footerBorderRadius${t}`],"border-radius"),"text-align":e[`footerAlignment${t}`]},{selector:`.${u} .gkit-table__caption`,...c(e.captionTypography,t),...a(e[`captionPadding${t}`],"padding"),...a(e[`captionMargin${t}`],"margin"),...a(e[`captionBorderRadius${t}`],"border-radius"),"text-align":e[`captionAlignment${t}`]},{selector:`.${u} tbody td`,...c(e.cellTypography,t),...a(e[`cellPadding${t}`],"padding"),...a(e[`cellBorderRadius${t}`],"border-radius"),"text-align":e[`cellAlignment${t}`]}]],t)})(e,z)),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(C,{blocksCSS:e?.blocksCSS}),q&&(0,o.createElement)(n.BlockControls,null,(0,o.createElement)(y.Toolbar,null,(0,o.createElement)(y.ToolbarButton,{icon:(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,o.createElement)("path",{d:"m20 3 1 1v16l-1 1H4l-1-1V4l1-1h16zm-9 2H5v6h2V9l3 3-3 3v-2H5v6h6v-2h2v2h6v-6h-2v2l-3-3 3-3v2h2V5h-6v2h-2V5zm2 8v2h-2v-2h2zm0-4v2h-2V9h2z"})),onClick:()=>{Y(!J),Q&&X(!1)},title:"Merge selected columns"})),h&&(0,o.createElement)(y.Toolbar,null,(0,o.createElement)(y.ToolbarButton,{icon:(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,o.createElement)("g",{fill:"#0F0F0F"},(0,o.createElement)("path",{d:"M18 3H4L3 4v14a1 1 0 1 1-2 0V4c0-2 1-3 3-3h14a1 1 0 1 1 0 2ZM13 11a1 1 0 1 1 2 0v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0v-2h-2a1 1 0 1 1 0-2h2v-2Z"}),(0,o.createElement)("path",{fillRule:"evenodd",d:"M20 5c2 0 3 1 3 3v12c0 2-1 3-3 3H8c-2 0-3-1-3-3V8c0-2 1-3 3-3h12Zm0 2 1 1v12l-1 1H8l-1-1V8l1-1h12Z",clipRule:"evenodd"}))),onClick:()=>((e,t,l,o)=>{if(null==o||o<0||o>=e.columnCount)return;const{columnCount:r,headers:a,footers:n}=e,i=[...a];i.splice(o+1,0,{...i[o]});const c=[...n];c.splice(o+1,0,{...c[o]}),t({columnCount:r+1,headers:i,footers:c}),setTimeout((()=>{const{getBlocks:e}=wp.data.select("core/block-editor"),{replaceInnerBlocks:t}=wp.data.dispatch("core/block-editor");try{e(l).forEach((l=>{const r=e(l.clientId);if(r[o]){const e=r[o],a=wp.blocks.createBlock(e.name,{...e.attributes},N(e.innerBlocks||[])),n=[...r];n.splice(o+1,0,a),t(l.clientId,n,!1)}}))}catch(e){console.error("Column duplication failed:",e)}}),100)})(e,t,l,W),title:"Duplicate selected column"}))),q&&(Q||J)&&(0,o.createElement)(M,{attributes:e,setAttributes:t,setMergePopOverOpen:Y,isVisible:!Q&&J,externalTableRef:L}),e?.variationType&&(0,o.createElement)(B,{attributes:e,setAttributes:t,device:A,advancedControl:r,clientId:l}),(0,o.createElement)("figure",{...R},v?(0,o.createElement)(o.Fragment,null,K?Z():U?(0,o.createElement)(y.Placeholder,{label:(0,a.__)("Table"),icon:(0,o.createElement)(n.BlockIcon,{icon:F,showColors:!0}),instructions:(0,a.__)("Insert a table for sharing data.")},(0,o.createElement)("form",{className:"blocks-table__placeholder-form",onSubmit:()=>t({isEmpty:!1})},(0,o.createElement)(S,{label:(0,a.__)("Show Header","table-builder-block"),value:e?.hasHeader,onChange:e=>t({hasHeader:e})}),(0,o.createElement)(S,{label:(0,a.__)("Show Footer","table-builder-block"),value:e?.hasFooter,onChange:e=>t({hasFooter:e})}),(0,o.createElement)(k,{__next40pxDefaultSize:!0,label:(0,a.__)("Column count"),value:b,onChange:e=>{const l=Array.from({length:e},((e,t)=>({title:`Header ${t+1}`}))),o=Array.from({length:e},((e,t)=>({title:`Footer ${t+1}`})));t({columnCount:e,headers:l,footers:o})},min:1,className:"blocks-table__placeholder-input"}),(0,o.createElement)(k,{__next40pxDefaultSize:!0,label:(0,a.__)("Row count"),value:u,onChange:e=>t({rowCount:e}),min:1,className:"blocks-table__placeholder-input"}),(0,o.createElement)(y.Button,{__next40pxDefaultSize:!0,variant:"primary",type:"submit"},(0,a.__)("Create Table")))):Z()):(0,o.createElement)(o.Fragment,null,(0,o.createElement)("table",{className:"gkit-table",ref:L},h&&(0,o.createElement)("thead",{className:"gkit-table__header"},(0,o.createElement)("tr",null,V)),(0,o.createElement)("tbody",{...I}),f&&(0,o.createElement)("tfoot",{className:"gkit-table__footer"},(0,o.createElement)("tr",null,D))),e.showCaption&&(0,o.createElement)(n.RichText,{identifier:"caption",tagName:"figcaption",className:"gkit-table__caption",value:d,onChange:e=>t({caption:e}),placeholder:"Caption for Table"}))))},icon:{src:(0,o.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 23 22",style:{fill:"none"},className:"tablekit-block-icon"},(0,o.createElement)("path",{stroke:"#111522",strokeMiterlimit:"10",strokeWidth:"1.5",d:"M17 18H2l-1-2V3l1-2h17l2 2v13M1 6h20M1 12h20M7 1v17"}),(0,o.createElement)("path",{stroke:"#111522",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"1.5",d:"m19 18 2 2m-2-2 3-1-7-3 3 7 1-3Z"}))},save:function({attributes:e}){const{caption:t,headers:l,footers:r,hasHeader:a,hasFooter:i,isEmpty:c}=e,s={enableSorting:e.enableSorting||!1,tableConditionalFormat:e.tableConditionalFormat||[],mergeTableCell:e.mergeTableCell,freezeSettings:e.freezeSettings,blockClass:e.blockClass||"",enableFreeze:e.enableFreeze||!1},d=n.useBlockProps.save({"data-settings":JSON.stringify(s)}),u=n.useInnerBlocksProps.save({className:"gkit-table__body"}),b=l.map(((e,t)=>(0,o.createElement)("th",{key:t,className:"gkit-table__header-content"},(0,o.createElement)(n.RichText.Content,{identifier:`header-${t}`,tagName:"div",value:e.title})))),m=r.map(((e,t)=>(0,o.createElement)("td",{key:t,className:"gkit-table__footer-content"},(0,o.createElement)(n.RichText.Content,{identifier:`footer-${t}`,tagName:"div",value:e.title}))));return(0,o.createElement)("figure",{...d},!c&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("table",{className:"gkit-table"},a&&(0,o.createElement)("thead",{className:"gkit-table__header"},(0,o.createElement)("tr",null,b)),(0,o.createElement)("tbody",{...u}),i&&(0,o.createElement)("tfoot",{className:"gkit-table__footer"},(0,o.createElement)("tr",null,m))),e.showCaption&&(0,o.createElement)(n.RichText.Content,{identifier:"caption",tagName:"figcaption",className:"gkit-table__caption",value:t})))},deprecated:c})},20:(e,t,l)=>{var o=l(609),r=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),n=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,l){var o,c={},s=null,d=null;for(o in void 0!==l&&(s=""+l),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,o)&&!i.hasOwnProperty(o)&&(c[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===c[o]&&(c[o]=t[o]);return{$$typeof:r,type:e,key:s,ref:d,props:c,_owner:n.current}}},848:(e,t,l)=>{e.exports=l(20)},609:e=>{e.exports=window.React}},l={};function o(e){var r=l[e];if(void 0!==r)return r.exports;var a=l[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,l,r,a)=>{if(!l){var n=1/0;for(d=0;d<e.length;d++){for(var[l,r,a]=e[d],i=!0,c=0;c<l.length;c++)(!1&a||n>=a)&&Object.keys(o.O).every((e=>o.O[e](l[c])))?l.splice(c--,1):(i=!1,a<n&&(n=a));if(i){e.splice(d--,1);var s=r();void 0!==s&&(t=s)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[l,r,a]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={283:0,595:0};o.O.j=t=>0===e[t];var t=(t,l)=>{var r,a,[n,i,c]=l,s=0;if(n.some((t=>0!==e[t]))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(c)var d=c(o)}for(t&&t(l);s<n.length;s++)a=n[s],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},l=globalThis.webpackChunktable_builder_block=globalThis.webpackChunktable_builder_block||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var r=o.O(void 0,[595],(()=>o(746)));r=o.O(r)})();